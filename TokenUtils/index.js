(function(m,A,U,h,B,C,$,b){"use strict";function E(e){const{metro:{findByProps:c,findByStoreName:i,common:{lodash:{merge:o}}}}=e,n=c("_sendMessage"),{createBotMessage:t}=c("createBotMessage"),r=c("BOT_AVATARS"),{getChannelId:p}=i("SelectedChannelStore");return function(d,s){var u;if(d.channelId??(d.channelId=p()),[null,void 0].includes(d.channelId))throw new Error("No channel id to receive the message into (channelId)");let l=d;if(d.really){typeof s=="object"&&(l=o(l,s));const a=[l,{}];(u=a[0]).tts??(u.tts=!1);for(const f of["allowedMentions","messageReference"])f in a[0]&&(a[1][f]=a[0][f],delete a[0][f]);const v="overwriteSendMessageArg2";return v in a[0]&&(a[1]=a[0][v],delete a[0][v]),n._sendMessage(d.channelId,...a)}return s!==!0&&(l=t(l)),typeof s=="object"&&(l=o(l,s),typeof s.author=="object"&&function(){const a=s.author;typeof a.avatarURL=="string"&&(r.BOT_AVATARS[a.avatar??a.avatarURL]=a.avatarURL,a.avatar??(a.avatar=a.avatarURL),delete a.avatarURL)}()),n.receiveMessage(l.channel_id,l),l}}function S(e,c,i){if(!e?.name||!e?.description)throw new Error(`No name(${e?.name}) or description(${e?.description}) in the passed command (command name: ${e?.name})`);if(e.displayName??(e.displayName=c?.names?.[i]??e.name),e.displayDescription??(e.displayDescription=c?.names?.[i]??e.description),e.options){if(!Array.isArray(e.options))throw new Error(`Options is not an array (received: ${typeof e.options})`);for(var o=0;o<e.options.length;o++){const t=e.options[o];if(!t?.name||!t?.description)throw new Error(`No name(${t?.name}) or description(${t?.description} in the option with index ${o}`);if(t.displayName??(t.displayName=c?.options?.[o]?.names?.[i]??t.name),t.displayDescription??(t.displayDescription=c?.options?.[o]?.descriptions?.[i]??t.description),t?.choices){if(!Array.isArray(t?.choices))throw new Error(`Choices is not an array (received: ${typeof t.choices})`);for(var n=0;n<t.choices.length;n++){const r=t.choices[n];if(!r?.name)throw new Error(`No name of choice with index ${n} in option with index ${o}`);r.displayName??(r.displayName=c?.options?.[o]?.choices?.[n]?.names?.[i]??r.name)}}}}return e}function P(e){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:27;if(typeof e!="string")throw new Error("Passed chars isn't a string");if(e?.length<=0)throw new Error("Invalid chars length");let i="";for(let o=0;o<c;o++)i+=e[Math.floor(Math.random()*e.length)];return i}const T={getLoading(){return Math.random()<.01?this.aol:this.loadingDiscordSpinner},getFailure(){return Math.random()<.01?this.fuckyoy:this.linuth},getSuccess(){return""},loadingDiscordSpinner:"a:loading:1105495814073229393",aol:"a:aol:1108834296359301161",linuth:":linuth:1110531631409811547",fuckyoy:":fuckyoy:1108360628302782564"},R={command:"https://cdn.discordapp.com/attachments/1099116247364407337/1112129955053187203/command.png"},M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=M.replace("+/","_-");function I(e,c){if(typeof e!="number")throw new Error(`Passed data isn't a number (received: ${typeof e})`);let i="";for(;e>0;)i=(c?N:M).charAt(e%64)+i,e=Math.floor(e/64);return i}const{meta:{resolveSemanticColor:O}}=h.findByProps("colors","meta"),_=h.findByStoreName("ThemeStore"),g=function(){return parseInt(O(_.theme,A.semanticColors.BACKGROUND_SECONDARY).slice(1),16)},y={author:{username:"TokenUtils",avatar:"command",avatarURL:R.command}};let w;function k(){return window.sendMessage?window.sendMessage?.(...arguments):(w||(w=E(vendetta)),w(...arguments))}var D={meta:vendetta.plugin,patches:[],onUnload(){this.patches.forEach(function(e){return e()}),this.patches=[]},onLoad(){var e=this;const c="Copy Token",i=$.before("render",h.findByProps("ScrollView").View,function(o){try{let n=B.findInReactTree(o,function(s){return s.key===".$UserProfileOverflow"});if(!n||!n.props||n.props.sheetKey!=="UserProfileOverflow")return;const t=n.props.content.props;if(t.options.some(function(s){return s?.label===c}))return;const r=h.findByStoreName("UserStore").getCurrentUser()?.id,p=Object.keys(n._owner.stateNode._keyChildMapping).find(function(s){return n._owner.stateNode._keyChildMapping[s]&&s.match(/(?<=\$UserProfile)\d+/)})?.slice?.(13)||r,d=h.findByProps("getToken").getToken();t.options.unshift({isDestructive:!0,label:c,onPress:function(){try{b.showToast(p===r?"Copied your token":`Copied token of ${t.header.title}`),C.setString(p===r?d:[Buffer.from(p).toString("base64").replaceAll("=",""),I(+Date.now()-129384e4,!0),P(N,27)].join(".")),t.hideActionSheet()}catch(s){console.error(s);let u=!1;try{u=i()}catch{u=!1}alert(`[TokenUtils \u2192 context menu patch \u2192 option onPress] failed. Patch ${u?"dis":"en"}abled
`+s.stack)}}})}catch(n){console.error(n);let t=!1;try{t=i()}catch{t=!1}alert(`[TokenUtils \u2192 context menu patch] failed. Patch ${t?"dis":"en"}abled
`+n.stack)}});this.patches.push(i);try{const o={get(n,t){try{const r={...y,interaction:{name:"/token get",user:h.findByStoreName("UserStore").getCurrentUser()}},{getToken:p}=h.findByProps("getToken");k({loggingName:"Token get output message",channelId:t.channel.id,embeds:[{color:g(),type:"rich",title:"Token of the current account",description:`${p()}`}]},r)}catch(r){console.error(r),alert(`There was an error while exeCuting /token get
`+r.stack)}},login(n,t){try{const r={...y,interaction:{name:"/token login",user:h.findByStoreName("UserStore").getCurrentUser()}},p=new Map(n.map(function(d){return[d.name,d]})).get("token").value;try{k({loggingName:"Token login process message",channelId:t.channel.id,embeds:[{color:g(),type:"rich",title:`<${T.getLoading()}> Switching accounts\u2026`}]},r),h.findByProps("login","logout","switchAccountToken").switchAccountToken(p)}catch(d){console.error(d),k({loggingName:"Token login failure message",channelId:t.channel.id,embeds:[{color:g(),type:"rich",title:`<${T.getFailure()}> Failed to switch accounts`,description:`${d.message}`}]},r)}}catch(r){console.error(r),alert(`There was an error while executing /token login
`+r.stack)}}};[S({type:1,inputType:1,applicationId:"-1",execute:o.get,name:"token get",description:"Shows your current user token"}),S({type:1,inputType:1,applicationId:"-1",execute:o.login,name:"token login",description:"Logs into an account using a token",options:[{required:!0,type:3,name:"token",description:"Token of the account to login into"}]})].forEach(function(n){return e.patches.push(U.registerCommand(n))})}catch(o){console.error(o),alert(`There was an error while loading TokenUtils
`+o.stack)}}};return m.EMBED_COLOR=g,m.authorMods=y,m.default=D,Object.defineProperty(m,"__esModule",{value:!0}),m})({},vendetta.ui,vendetta.commands,vendetta.metro,vendetta.utils,vendetta.metro.common.clipboard,vendetta.patcher,vendetta.ui.toasts);
