(function(v,h,t,f,z,g,d,B,F,G,$,H){"use strict";var A={string:function(e,n){return e.split(n?/(?=[A-Z])/:"_").map(function(a){return a[0].toUpperCase()+a.slice(1)}).join(" ")}};async function q(e,n){let{fromLanguage:a,toLanguage:l}=n;const s="https://translate.googleapis.com/translate_a/single?"+new URLSearchParams({client:"gtx",sl:a,tl:l,dt:"t",dj:"1",source:"input",q:e}),r=await fetch(s);if(!r.ok)throw new Error("Failed to translate");const{src:i,sentences:T}=await r.json();return{src:i,text:T.map(function(_){return _?.trans}).filter(Boolean).join("")}}async function V(e,n,a,l){let{fromLanguage:s="detect",toLanguage:r="english"}=n;const i=await q(e,{fromLanguage:a[s],toLanguage:a[r]});return l?e:i.text}var x={translate:V},C,O,M;(C=g.storage).DislateLangFrom??(C.DislateLangFrom="detect"),(O=g.storage).DislateLangTo??(O.DislateLangTo="english"),(M=g.storage).DislateLangAbbr??(M.DislateLangAbbr=!1);let o=g.storage;var X=h.findByProps("sendBotMessage"),m=["detect","amharic","arabic","aymara","assamese","akan","azerbaijani","belarusian","bulgarian","bambara","bengali","corsican","czech","bosnian","danish","catalan","valencian","german","ewe","divehi","dhivehi","maldivian","english","greek","estonian","esperanto","basque","spanish","castilian","finnish","french","persian","irish","galician","guarani","western_frisian","gujarati","gaelic","scottish_gaelic","hausa","croatian","hebrew","hindi","haitian","haitian_creole","armenian","indonesian","hungarian","igbo","icelandic","italian","georgian","javanese","japanese","korean","kazakh","kannada","afrikaans","central_khmer","welsh","kurdish","kirghiz","kyrgyz","latin","luxembourgish","letzeburgesch","ganda","lao","latvian","lingala","lithuanian","malagasy","macedonian","malayalam","maori","marathi","norwegian_bokm\xE5l","mongolian","burmese","maltese","nepali","malay","dutch","flemish","chichewa","chewa","nyanja","norwegian","oromo","oriya","panjabi","punjabi","polish","quechua","pushto","pashto","russian","sanskrit","romanian","moldavian","moldovan","slovenian","kinyarwanda","slovak","sinhala","sinhalese","samoan","shona","somali","serbian","albanian","swahili","southern_sotho","swedish","sundanese","tamil","tajik","telugu","tagalog","turkmen","tigrinya","thai","tsonga","sindhi","portuguese","twi","turkish","tatar","urdu","ukrainian","uighur","uyghur","uzbek","vietnamese","yiddish","xhosa","chinese_traditional","chinese_simplified","zulu","yoruba"],U=["auto","am","ar","ay","as","ak","az","be","bg","bm","bn","co","cs","bs","da","ca","ca","de","ee","dv","dv","dv","en","el","et","eo","eu","es","es","fi","fr","fa","ga","gl","gn","fy","gu","gd","gd","ha","hr","he","hi","ht","ht","hy","id","hu","ig","is","it","ka","jv","ja","ko","kk","kn","af","km","cy","ku","ky","ky","la","lb","lb","lg","lo","lv","ln","lt","mg","mk","ml","mi","mr","nb","mn","my","mt","ne","ms","nl","nl","ny","ny","ny","no","om","or","pa","pa","pl","qu","ps","ps","ru","sa","ro","ro","ro","sl","rw","sk","si","si","sm","sn","so","sr","sq","sw","st","sv","su","ta","tg","te","tl","tk","ti","th","ts","sd","pt","tw","tr","tt","ur","uk","ug","ug","uz","vi","yi","xh","zh-tw","zh-cn","zu","yo"];const{FormRow:E}=d.Forms,{ScrollView:Y}=t.ReactNative;function K(){const[e,n]=t.React.useState("");return t.React.createElement(Y,{style:{flex:1}},t.React.createElement(d.Search,{style:{padding:15},placeholder:"Search Language",onChangeText:function(a){n(a)}}),Object.values(m).filter(function(a){return a!=="detect"}).filter(function(a){return a.includes(e)}).map(function(a,l){return t.React.createElement(E,{label:a,trailing:function(){return t.React.createElement(E.Arrow,null)},onPress:function(){o.DislateLangTo!=a&&(o.DislateLangTo=a,G.showToast(`Saved ToLang to ${o.DislateLangTo}`,f.getAssetIDByName("check")))}})}))}const{ScrollView:J,Text:Q}=t.ReactNative,{FormRow:L}=d.Forms,Z=t.stylesheet.createThemedStyleSheet({subheaderText:{color:F.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:t.constants.Fonts.PRIMARY_BOLD,fontSize:14}});function W(){const e=t.NavigationNative.useNavigation();return t.React.createElement(J,null,t.React.createElement(L,{label:"Translate to",subLabel:o.DislateLangTo,leading:t.React.createElement(L.Icon,{source:f.getAssetIDByName("ic_activity_24px")}),trailing:function(){return t.React.createElement(L.Arrow,null)},onPress:function(){return e.push("VendettaCustomPage",{title:"Translate to",render:K})}}),t.React.createElement(Q,{style:Z.subheaderText,onPress:function(){return t.url.openURL("https://github.com/aeongdesu/vdplugins")}},`Build: (${g.manifest.hash.substring(0,7)})`))}var N;(function(e){e[e.BUILT_IN=0]="BUILT_IN",e[e.BUILT_IN_TEXT=1]="BUILT_IN_TEXT",e[e.BUILT_IN_INTEGRATION=2]="BUILT_IN_INTEGRATION",e[e.BOT=3]="BOT",e[e.PLACEHOLDER=4]="PLACEHOLDER"})(N||(N={}));var p;(function(e){e[e.SUB_COMMAND=1]="SUB_COMMAND",e[e.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",e[e.STRING=3]="STRING",e[e.INTEGER=4]="INTEGER",e[e.BOOLEAN=5]="BOOLEAN",e[e.USER=6]="USER",e[e.CHANNEL=7]="CHANNEL",e[e.ROLE=8]="ROLE",e[e.MENTIONABLE=9]="MENTIONABLE",e[e.NUMBER=10]="NUMBER",e[e.ATTACHMENT=11]="ATTACHMENT"})(p||(p={}));var R;(function(e){e[e.CHAT=1]="CHAT",e[e.USER=2]="USER",e[e.MESSAGE=3]="MESSAGE"})(R||(R={}));const ee=m.filter(function(e){return e!=="detect"}).map(function(e){return{name:A.string(e),displayName:A.string(e),value:e}});var ae=$.registerCommand({id:"translate",name:"translate",displayName:"translate",description:"Send a message using Dislate in any language chosen, using the Google Translate API.",displayDescription:"Send a message using Dislate in any language chosen, using the Google Translate API.",type:R.CHAT,inputType:N.BUILT_IN_TEXT,options:[{name:"text",displayName:"text",description:"The text/message for Dislate to translate. Please note some formatting of mentions and emojis may break due to the API.",displayDescription:"The text/message for Dislate to translate. Please note some formatting of mentions and emojis may break due to the API.",type:p.STRING,required:!0},{name:"language",displayName:"language",description:'The language that Dislate will translate the text into. This can be any language from the list, except "Detect".',displayDescription:'The language that Dislate will translate the text into. This can be any language from the list, except "Detect".',type:p.STRING,choices:[...ee],required:!0}],async execute(e,n){const a=e.find(function(i){return i.name==="text"}).value,l=e.find(function(i){return i.name==="language"}).value,s=Object.assign({},...m.map(function(i,T){return{[i]:U[T]}})),r=await x.translate(a,{fromLanguage:o.DislateLangFrom,toLanguage:l},s);return r?await new Promise(function(i){return H.showConfirmationAlert({title:"Are you sure you want to send it?",content:React.createElement(React.Fragment,null,React.createElement(d.Codeblock,null,r)),confirmText:"Yep, send it!",onConfirm:function(){return i({content:r})},cancelText:"Nope, don't send it"})}):X.sendBotMessage(n.channel.id,`Failed to translate: ${a}`)}});const te=[ae],P=h.findByProps("openLazy","hideActionSheet"),ne=h.findByStoreName("MessageStore"),ie=h.findByStoreName("ChannelStore"),{FormRow:se,FormIcon:re}=d.Forms,j=Object.assign({},...m.map(function(e,n){return{[e]:U[n]}}));let y=[{invalid_id:"rosie and sapphire sucks"}],oe=[];var le={onLoad:function(){B.before("openLazy",P,function(e){let[n,a,l]=e;const s=l?.message;a!=="MessageLongPressActionSheet"||!s||n.then(function(r){const i=B.after("default",r,function(T,_){t.React.useEffect(function(){return function(){i()}},[]);const D=z.findInReactTree(_,function(c){return c?.[0]?.type?.name==="ButtonRow"});if(!D)return;const ce=Math.max(D.findIndex(function(c){return c.props.message===t.i18n.Messages.MARK_UNREAD}),0),u=ne.getMessage(s.channel_id,s.id);if(!u?.content&&!s.content)return;const k=u.id??s.id,ue=u.content??s.content,w=y.find(function(c){return Object.keys(c)[0]===k},"cache object");let I=w?"Revert":"Translate";const ge=async function(c){const de=c??o.DislateLangFrom,S=o.DislateLangTo,b=I==="Translate",he=await x.translate(u.content,{fromLanguage:de,toLanguage:S},j,!b);t.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...u,content:`${b?he:w[k]} ${b?`\`[${o.DislateLangAbbr?j[S].toUpperCase():A.string(S)}]\``:""}`,guild_id:ie.getChannel(u.channel_id).guild_id},log_edit:!1}),b?y.unshift({[k]:ue}):y=y.filter(function(fe){return fe!==w},"cached data override")};D.splice(ce,0,t.React.createElement(se,{label:`${I} Message`,leading:t.React.createElement(re,{style:{opacity:1},source:I==="Translate"?f.getAssetIDByName("ic_locale_24px"):f.getAssetIDByName("ic_highlight")}),onPress:async function(){await ge(),P.hideActionSheet()}}))})})})},onUnload:function(){for(const e of te)e();for(const e of oe)e()},settings:W};return v.default=le,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta.metro,vendetta.metro.common,vendetta.ui.assets,vendetta.utils,vendetta.plugin,vendetta.ui.components,vendetta.patcher,vendetta.ui,vendetta.ui.toasts,vendetta.commands,vendetta.ui.alerts);
